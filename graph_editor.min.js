(function(){var e,g,h,i,c,a,b,f,d;g=function(j,k){graph.nodes.x.push(j);return graph.nodes.y.push(k)-1;};b=function(j,l,k){if(k<graph.nodes.x.length){graph.nodes.x.push(graph.nodes.x[k]);
graph.nodes.y.push(graph.nodes.y[k]);}graph.nodes.x[k]=j;graph.nodes.y[k]=l;return k;};i=function(k){var j,l;l=null;if((k<(j=graph.nodes.x.length))&&(k>-1)){if(k===j-1){l=[graph.nodes.x.pop(),graph.nodes.y.pop()];
}else{l=[graph.nodes.x[k],graph.nodes.y[k]];graph.nodes.x[k]=graph.nodes.x.pop();graph.nodes.y[k]=graph.nodes.y.pop();}}return l;};this.move_node=function(k,j,l){graph.nodes.x[k]=j;
graph.nodes.y[k]=l;return null;};e=function(k,j){var m,l;m=c(j,k);l=graph.edges.push(pack(k,j))-1;if((graph.curved[l]=m>=0)){graph.curved[m]=true;}return l;
};a=function(l,j,k){var m;m=c(j,l);if(k<graph.edges.length){graph.edges.push(graph.edges[k]);graph.curved.push(graph.curved[k]);}graph.edges[k]=pack(l,j);
if(m<0){graph.curved[k]=false;}else{if(m===k){m=graph.edges.length-1;}graph.curved[k]=graph.curved[m]=true;}return k;};h=function(m){var l,k,o,j,n,p;n=null;
if((m<(j=graph.edges.length))&&(m>-1)){p=unpack(graph.edges[m]),l=p[0],k=p[1];if(m===j-1){n=graph.edges.pop();graph.curved.pop();}else{n=graph.edges[m];
graph.edges[m]=graph.edges.pop();graph.curved[m]=graph.curved.pop();}if((o=c(k,l))>=0){graph.curved[o]=false;}}return n;};c=function(j,n){var o,m,l,q,k,p;
l=pack(j,n);p=graph.edges;for(m=q=0,k=p.length;q<k;m=++q){o=p[m];if(o===l){return m;}}return -1;};d=function(j,k){graph.edges[j]=k;return null;};f=function(m,l){var n,j,p,k,o;
o=graph.nodes.x;for(n=p=0,k=o.length;p<k;n=++p){j=o[n];graph.nodes.x[n]+=m;graph.nodes.y[n]+=l;}return null;};this.editor={stack:[],ix:0,transaction:false,execute:function(){var k,j;
j=arguments[0];k=Array.prototype.slice.call(arguments).splice(1);if(!!this[j]){return this[j].apply(this,k);}console.log("Command not found: "+j+" ("+k+")");
return null;},undo:function(){var k,j;j=false;if(this.ix>0){while(this.ix>0){k=this.stack[--this.ix];k.undo_func.apply(this,k.undo_vals);if(!this.transaction){break;
}}j=true;}return j;},redo:function(){var k,j;j=false;if(this.ix<this.stack.length){while(this.ix<this.stack.length){k=this.stack[this.ix++];k.redo_func.apply(this,k.redo_vals);
if(!this.transaction){break;}}j=true;}return j;},to_stack:function(l,m,j,k){if(this.ix<this.stack.length){this.stack.length=this.ix;}this.stack.push({redo_func:l,redo_vals:m,undo_func:j,undo_vals:k});
this.ix=this.stack.length;return null;},set_transaction:function(j){return this.transaction=j;},start_transaction:function(){return this.to_stack(this.set_transaction,[true],this.set_transaction,[false]);
},stop_transaction:function(){return this.to_stack(this.set_transaction,[false],this.set_transaction,[true]);},add_node:function(j,l){var k;k=g(j,l);this.to_stack(g,arguments,i,[k]);
return k;},del_node:function(k){var m,r,q,o,j,p,n,l;p=graph.nodes.x[k];n=graph.nodes.y[k];r=graph.nodes.length-1;i(k);this.start_transaction();this.to_stack(i,[k],b,[p,n,k]);
m=graph.edges.length;while(m-->0){l=unpack(graph.edges[m]),q=l[0],o=l[1];if((q===k)||(o===k)){this.del_edge(m);}else{if(k<r){j=graph.edges[m];if(q===r){q=k;
}if(o===r){o=k;}if((q===k)||(o===k)){d(m,pack(q,o));this.to_stack(d,[m,graph.edges[m]],d,[m,j]);}}}}this.stop_transaction();return null;},move_node:function(j,l,n,k,m){this.to_stack(move_node,[j,k,m],move_node,[j,l,n]);
return null;},add_edge:function(l,j){var k;k=e(l,j);this.to_stack(e,[l,j],h,[k]);return k;},del_edge:function(j){var k,n,m,l;k=h(j);l=unpack(k),n=l[0],m=l[1];
this.to_stack(h,[j],a,[n,m,j]);return null;},move_graph:function(m,o,l,n){var k,j;k=l-m;j=n-o;if(k||j){f(k,j);this.to_stack(f,[k,j],f,[-k,-j]);}return null;
}};}).call(this);