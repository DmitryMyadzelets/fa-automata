!function(){function d(){return{nodes:[],edges:[]}}function e(){this.node=this.node.data(this._graph.nodes),this.node.enter().call(c.add_node),this.node.exit().remove(),this.link=this.link.data(this._graph.edges),this.link.enter().call(c.add_link),this.link.exit().remove(),this.force.start()}function f(a){this._graph=null,this._graph=a||d(),this.force.nodes(this._graph.nodes).links(this._graph.edges),e.call(this)}function g(a,b){var d=this,e=d3.select(a||"body"),g=500,h=300,i=e.append("svg").attr("width",g).attr("height",h).on("contextmenu",function(){d3.event.preventDefault()});i=i.append("g"),i.append("svg:defs").append("svg:marker").attr("id","marker-arrow").attr("orient","auto").attr("markerWidth",6).attr("markerHeight",6).attr("refX",6).attr("refY",3).append("svg:path").attr("d","M0,0 L6,3 L0,6"),this.force=d3.layout.force().charge(-800).linkDistance(150).chargeDistance(450).size([g,h]).on("tick",function(){d.node.attr("transform",c.get_node_transformation),d.link.selectAll("path").attr("d",c.get_link_transformation)}),this.node=i.append("g").attr("class","nodes").selectAll("g"),this.link=i.append("g").attr("class","links").selectAll("g"),f.call(this,b)}var a={version:"1.0.0"},b={length:function(a){return Math.sqrt(a[0]*a[0]+a[1]*a[1])},normalize:function(a,b){var c=this.length(a);return c=1/c,b[0]=a[0]*c,b[1]=a[1]*c,b},orthogonal:function(a,b){return b[0]=a[1],b[1]=-a[0],b},scale:function(a,b,c){return c[0]=a[0]*b,c[1]=a[1]*b,c},add:function(a,b,c){return c[0]=a[0]+b[0],c[1]=a[1]+b[1],c},subtract:function(a,b,c){return c[0]=a[0]-b[0],c[1]=a[1]-b[1],c},copy:function(a,b){return b[0]=a[0],b[1]=a[1],b}},c={};c.make_edge=function(){var a=[0,0],c=16,d=[0,0],e=function(){var a=Math.PI/3,b=Math.PI/12;return{DX1:c*Math.cos(a),DY1:c*Math.sin(a),DX2:4*c*Math.cos(a),DY2:4*c*Math.sin(a),DX3:4*c*Math.cos(b),DY3:4*c*Math.sin(b),DX4:c*Math.cos(b),DY4:c*Math.sin(b),NX:Math.cos(a-Math.PI/24),NY:Math.sin(a-Math.PI/24)}}();return{stright:function(e,f){b.subtract(f,e,a),b.normalize(a,d),b.scale(d,c,a),b.add(e,a,e),b.subtract(f,a,f)},drag:function(e,f,g){b.subtract(f,e,a),b.normalize(a,d),b.scale(d,c,a),b.add(e,a,e),g&&b.subtract(f,a,f)},curve:function(e,f,g){b.subtract(f,e,a),b.normalize(a,d),g[0]=.5*(e[0]+f[0])+2*d[1]*c,g[1]=.5*(e[1]+f[1])-2*d[0]*c,b.copy(g,a),this.stright(e,a),b.copy(g,a),this.stright(f,a)},loop:function(c,d,f,g){b.copy(c,a),c[0]=a[0]+e.DX1,c[1]=a[1]-e.DY1,f[0]=a[0]+e.DX2,f[1]=a[1]-e.DY2,g[0]=a[0]+e.DX3,g[1]=a[1]-e.DY3,d[0]=a[0]+e.DX4,d[1]=a[1]-e.DY4}}}(),c.get_link_transformation=function(){var a=[0,0],b=[0,0],d=[0,0],e=[0,0];return function(f){switch(a[0]=f.source.x,a[1]=f.source.y,b[0]=f.target.x,b[1]=f.target.y,f.type){case 1:c.make_edge.curve(a,b,d);break;case 2:c.make_edge.loop(a,b,d,e);break;default:c.make_edge.stright(a,b)}switch(f.x1=a[0],f.y1=a[1],f.x2=b[0],f.y2=b[1],f.type){case 1:return"M"+a[0]+","+a[1]+"Q"+d[0]+","+d[1]+","+b[0]+","+b[1];case 2:return"M"+a[0]+","+a[1]+"C"+d[0]+","+d[1]+","+e[0]+","+e[1]+","+b[0]+","+b[1];default:return"M"+a[0]+","+a[1]+"L"+b[0]+","+b[1]}}}(),c.get_node_transformation=function(a){return a.x=a.x||0,a.y=a.y||0,"translate("+a.x+","+a.y+")"},c.add_node=function(a){a.append("g").attr("transform",this.get_node_transformation).append("circle").attr("r",16)},c.add_link=function(a){var b=a.append("g");return b.append("path").attr("class","link").attr("marker-end","url(#marker-arrow)"),b.append("path").attr("class","catchlink"),b},g.prototype.graph=function(a){return arguments.length>0&&f.call(this,a),this._graph},a.view=function(a,b){return new g(a,b)},this.jA=this.jA||{},this.jA.editor=a}(window);